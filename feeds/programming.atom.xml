<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Larry G. Wapnitsky</title><link href="http://larry.wapnitsky.com/" rel="alternate"></link><link href="http://larry.wapnitsky.com/feeds/programming.atom.xml" rel="self"></link><id>http://larry.wapnitsky.com/</id><updated>2015-07-23T00:00:00-04:00</updated><entry><title>Splitting a CSV inÂ PowerShell</title><link href="http://larry.wapnitsky.com/posts/2015/Jul/23/splitting-a-csv-in-powershell.html" rel="alternate"></link><updated>2015-07-23T00:00:00-04:00</updated><author><name>Larry G. Wapnitsky</name></author><id>tag:larry.wapnitsky.com,2015-07-23:posts/2015/Jul/23/splitting-a-csv-in-powershell.html</id><summary type="html">

&lt;p&gt;Today I had a need to split some &lt;span class="caps"&gt;CSV&lt;/span&gt; (comma-separated value) files to run on a program that had limits to the size it could read.  I found a number of solutions out there to do what I wanted in PowerShell, but many were a bit more complex than I needed, so I wrote my&amp;nbsp;own.&lt;/p&gt;
&lt;!-- PELICAN END SUMMARY --&gt;

&lt;p&gt;To simplify things for my needs, I hard-coded my major variables, but changing this to a cmdlet with modular parameters won&amp;rsquo;t be that&amp;nbsp;difficult.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;csvfile&lt;/span&gt;&lt;span class="x"&gt; = import-csv &amp;quot;file.csv&amp;quot; -Encoding UTF8&lt;/span&gt;

&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;split&lt;/span&gt;&lt;span class="x"&gt; = 75&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Then, using some basic math built in to PowerShell and .&lt;span class="caps"&gt;NET&lt;/span&gt;, I figured out how many files I would be generating, using division, modulo, and floor\ceiling for&amp;nbsp;rounding.  &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;csvfile_split&lt;/span&gt;&lt;span class="x"&gt; = &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;csvfile&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nv"&gt;length&lt;/span&gt;&lt;span class="x"&gt; / &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;split&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;floor&lt;/span&gt;&lt;span class="x"&gt; = [math]::Floor(&lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;csvfile_split&lt;/span&gt;&lt;span class="x"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;ceiling&lt;/span&gt;&lt;span class="x"&gt; = [math]::Ceiling(&lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;csvfile_split&lt;/span&gt;&lt;span class="x"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;excess&lt;/span&gt;&lt;span class="x"&gt; = &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;csvfile&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nv"&gt;length&lt;/span&gt;&lt;span class="x"&gt; % &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;split&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We now start the iteration of the imported &lt;span class="caps"&gt;CSV&lt;/span&gt; file and create the proper number of split files. The value in &lt;em&gt;$excess&lt;/em&gt; lets me know if I need to create an extra file at the&amp;nbsp;end.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;start&lt;/span&gt;&lt;span class="x"&gt; = 0&lt;/span&gt;
&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;end&lt;/span&gt;&lt;span class="x"&gt; = &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;split&lt;/span&gt;&lt;span class="x"&gt; - 1&lt;/span&gt;

&lt;span class="x"&gt;switch (&lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;excess&lt;/span&gt;&lt;span class="x"&gt; -gt 0)&lt;/span&gt;
&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="x"&gt;    &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;true&lt;/span&gt;&lt;span class="x"&gt;   &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="x"&gt; &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;upper&lt;/span&gt;&lt;span class="x"&gt; = &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;ceiling&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="x"&gt;    &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;false&lt;/span&gt;&lt;span class="x"&gt;  &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="x"&gt; &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;upper&lt;/span&gt;&lt;span class="x"&gt; = &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;floor&lt;/span&gt;&lt;span class="x"&gt; }&lt;/span&gt;
&lt;span class="x"&gt;}&lt;/span&gt;

&lt;span class="x"&gt;for (&lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;i&lt;/span&gt;&lt;span class="x"&gt; = 1; &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;i&lt;/span&gt;&lt;span class="x"&gt; -le &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;upper&lt;/span&gt;&lt;span class="x"&gt;; &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;i&lt;/span&gt;&lt;span class="x"&gt;++) &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="x"&gt;    &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;csvfile&lt;/span&gt;&lt;span class="x"&gt;[&lt;/span&gt;&lt;span class="p"&gt;$($&lt;/span&gt;&lt;span class="nv"&gt;start&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="x"&gt;..&lt;/span&gt;&lt;span class="p"&gt;$($&lt;/span&gt;&lt;span class="nv"&gt;end&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="x"&gt;] | export-csv &amp;quot;split&lt;/span&gt;&lt;span class="p"&gt;$($&lt;/span&gt;&lt;span class="nv"&gt;i&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nv"&gt;csv&lt;/span&gt;&lt;span class="x"&gt;&amp;quot; -notypeinformation -Encoding UTF8&lt;/span&gt;
&lt;span class="x"&gt;    &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;start&lt;/span&gt;&lt;span class="x"&gt; += &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;split&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="x"&gt;    &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;end&lt;/span&gt;&lt;span class="x"&gt; += &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;split&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;

&lt;span class="x"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;strong&gt;Just that&amp;nbsp;simple!&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Here&amp;rsquo;s the full&amp;nbsp;code:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;csvfile&lt;/span&gt;&lt;span class="x"&gt; = import-csv &amp;quot;file.csv&amp;quot; -Encoding UTF8&lt;/span&gt;

&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;split&lt;/span&gt;&lt;span class="x"&gt; = 75&lt;/span&gt;

&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;csvfile_split&lt;/span&gt;&lt;span class="x"&gt; = &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;csvfile&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nv"&gt;length&lt;/span&gt;&lt;span class="x"&gt; / &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;split&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;floor&lt;/span&gt;&lt;span class="x"&gt; = [math]::Floor(&lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;csvfile_split&lt;/span&gt;&lt;span class="x"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;ceiling&lt;/span&gt;&lt;span class="x"&gt; = [math]::Ceiling(&lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;csvfile_split&lt;/span&gt;&lt;span class="x"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;excess&lt;/span&gt;&lt;span class="x"&gt; = &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;csvfile&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nv"&gt;length&lt;/span&gt;&lt;span class="x"&gt; % &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;split&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;

&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;start&lt;/span&gt;&lt;span class="x"&gt; = 0&lt;/span&gt;
&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;end&lt;/span&gt;&lt;span class="x"&gt; = &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;split&lt;/span&gt;&lt;span class="x"&gt; - 1&lt;/span&gt;

&lt;span class="x"&gt;switch (&lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;excess&lt;/span&gt;&lt;span class="x"&gt; -gt 0)&lt;/span&gt;
&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="x"&gt;    &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;true&lt;/span&gt;&lt;span class="x"&gt;   &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="x"&gt; &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;upper&lt;/span&gt;&lt;span class="x"&gt; = &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;ceiling&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="x"&gt;    &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;false&lt;/span&gt;&lt;span class="x"&gt;  &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="x"&gt; &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;upper&lt;/span&gt;&lt;span class="x"&gt; = &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;floor&lt;/span&gt;&lt;span class="x"&gt; }&lt;/span&gt;
&lt;span class="x"&gt;}&lt;/span&gt;

&lt;span class="x"&gt;for (&lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;i&lt;/span&gt;&lt;span class="x"&gt; = 1; &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;i&lt;/span&gt;&lt;span class="x"&gt; -le &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;upper&lt;/span&gt;&lt;span class="x"&gt;; &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;i&lt;/span&gt;&lt;span class="x"&gt;++) &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="x"&gt;    &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;csvfile&lt;/span&gt;&lt;span class="x"&gt;[&lt;/span&gt;&lt;span class="p"&gt;$($&lt;/span&gt;&lt;span class="nv"&gt;start&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="x"&gt;..&lt;/span&gt;&lt;span class="p"&gt;$($&lt;/span&gt;&lt;span class="nv"&gt;end&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="x"&gt;] | export-csv &amp;quot;split&lt;/span&gt;&lt;span class="p"&gt;$($&lt;/span&gt;&lt;span class="nv"&gt;i&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nv"&gt;csv&lt;/span&gt;&lt;span class="x"&gt;&amp;quot; -notypeinformation -Encoding UTF8&lt;/span&gt;
&lt;span class="x"&gt;    &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;start&lt;/span&gt;&lt;span class="x"&gt; += &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;split&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="x"&gt;    &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;end&lt;/span&gt;&lt;span class="x"&gt; += &lt;/span&gt;&lt;span class="p"&gt;$&lt;/span&gt;&lt;span class="nv"&gt;split&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;

&lt;span class="x"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary><category term="programming"></category><category term="PowerShell"></category><category term="scripting"></category><category term="IT"></category></entry><entry><title>Breaking down CSV file information byÂ date</title><link href="http://larry.wapnitsky.com/posts/2015/Mar/10/breaking-down-csv-file-information-by-date.html" rel="alternate"></link><updated>2015-03-11T00:00:00-04:00</updated><author><name>Larry G. Wapnitsky</name></author><id>tag:larry.wapnitsky.com,2015-03-10:posts/2015/Mar/10/breaking-down-csv-file-information-by-date.html</id><summary type="html">

&lt;p&gt;I had a need this morning to reconcile some reporting data for a large number of projects in Microsoft &lt;span class="caps"&gt;TFS&lt;/span&gt;. I exported the data using Team Foundation Sidekicks, but needed to break down the data by month within a certain range of dates. Here&amp;rsquo;s how I did it.
</summary><category term="programming"></category><category term="PowerShell"></category><category term="scripting"></category><category term="IT"></category></entry></feed>